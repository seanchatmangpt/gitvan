# GitVan v3.0.0 Cleanroom Test Dockerfile
# Comprehensive Docker-based testing environment

FROM node:20-alpine

# Install system dependencies
RUN apk add --no-cache \
    git \
    bash \
    curl \
    jq \
    && npm install -g pnpm

# Set working directory
WORKDIR /workspace

# Copy GitVan source files
COPY package.json pnpm-lock.yaml /gitvan/
COPY src/ /gitvan/src/
COPY packs/ /gitvan/packs/
COPY templates/ /gitvan/templates/
COPY bin/ /gitvan/bin/

# Install GitVan dependencies
WORKDIR /gitvan
RUN pnpm install --no-frozen-lockfile

# Set working directory back to workspace
WORKDIR /workspace

# Set default command to show help
CMD ["node", "/gitvan/src/cli.mjs", "--help"]