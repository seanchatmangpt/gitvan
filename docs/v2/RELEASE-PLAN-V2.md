# GitVan v2 — Release Plan (Revised)

## 0) Versioning & Branching

* **SemVer**: `v2.y.z` (y: features, z: fixes).
* **Branches**: `main` (active dev), `release/v2` (stabilization), `v2-lts` (post-GA fixes).
* **Tags**: signed, annotated `v2.0.0-α.N`, `-β.N`, `-rc.N`, `v2.0.0`.
* **Artifacts**: npm `gitvan` (ESM), changelog, SBOM (optional), checksums.

## 1) Trains & Dates (relative)

* **M1 Alpha (Core Hardening)** — +2 weeks
* **M2 Beta (Chat MVP)** — +4 weeks
* **M3 RC (Cookbook v1 + Perf)** — +3 weeks
* **M4 GA (Docs + Verify)** — +2 weeks
  Cadence: weekly cuts; hotfixes as needed.

## 2) Scope per Milestone & Exit Criteria

### M1 — Alpha: Core Hardening

**Scope**

* Jobs runner, cron, events, locks, receipts (notes), Nunjucks + inflection, composables (`useGit`, `useTemplate`, `useExec`), config loader, daemon.
* Playground + core E2E.
  **Exit**
* TTFJ ≤ 10 min (playground).
* p95 simple job ≤ 300 ms (local).
* 100% receipt coverage in tests.
* Path sandbox tests pass.
* Lock contention < 1% in worktree tests.

### M2 — Beta: Chat Copilot MVP

**Scope**

* Chat CLI (draft/generate/preview/apply/explain/refactor).
* Zod schemas for Job/Event/Template; wizard fallback.
* Deterministic receipts for chat ops (model, seed, params, hashes).
  **Exit**
* Chat → valid Zod spec ≥ 95% on first pass (seed prompts).
* “Apply” guarded by diff+confirm; policy hooks (`chat:beforeApply`, `policy:allowWrite`) green.
* Cookbook seed: 15 recipes runnable via chat.

### M3 — RC: Cookbook v1 + Performance

**Scope**

* 30+ dark-matter recipes; plan/dry-run UX; daemon status/locks UX; perf passes; acceptance test matrix (Win/Mac/Linux).
  **Exit**
* p95 simple job ≤ 300 ms; p99 ≤ 800 ms.
* Cross-platform green; CLI UX freeze; docs feature-complete.
* No P0/P1 issues open on `release/v2`.

### M4 — GA: Verify & Docs

**Scope**

* Final docs: Quickstart, API, Cookbook, Playground, Audit guide.
* Migration notes (v1→v2 if applicable).
  **Exit**
* Go/No-Go checklist 100% green.
* Signed `v2.0.0` tag; npm publish; website/readme updated.

## 3) Quality Gates (all trains)

* **Automated**: unit, integration, E2E (playground), perf smoke, path-safety, determinism (TZ/LANG/seed).
* **Manual**: install TTFJ, cookbook spot checks, chat flows.
* **Security**: dependency audit, sandbox write guards, signed tags.

## 4) Distribution & Rollout

* **npm**: `gitvan`.
* **Docs**: `/docs` + playground.
* **Release notes**: generated by job `docs:changelog`.
* **Pilot rollout**: 3 repos (dev-tools, docs, release-eng).
* **Backport policy**: GA fixes to `v2-lts` only (no features).

## 5) Observability (local, opt-in)

* CLI `--metrics` flag: TTFJ, p95, lock retries, chat valid-spec rate (no telemetry by default).
* Receipts: all runs (including chat) produce git-notes with hashes.

## 6) Risk & Mitigation

* **Spec drift (chat)** → strict Zod, wizard fallback, curated prompts.
* **Platform variances** → matrix tests; shell portability guards.
* **Lock collisions** → per-worktree scope, jittered retries.
* **Non-determinism** → capture seeds/params; mark non-replayable steps.

## 7) Comms

* Weekly status (bullet list) in `docs/status`.
* Alpha/Beta/RC/GA release notes + upgrade notes.

## 8) GA Go/No-Go Checklist

* ✅ CTQs met (TTFJ, p95, receipts 100%, sandbox 0 escapes, chat ≥95%).
* ✅ Cross-platform matrix green.
* ✅ Docs complete; examples runnable.
* ✅ Signed tag + npm publish dry-run OK.
* ✅ Rollback plan ready (yank, revert).

---

## Mock CLI Help (Release Ops)

```
gitvan release plan
  Show current milestone, open gates, and target dates.

gitvan release cut --tag v2.0.0-beta.2
  Create signed pre-release tag and generate notes.

gitvan release verify
  Run GA gates: perf, sandbox, receipts, cross-platform matrix.

gitvan release notes --since v2.0.0-beta.1
  Render changelog via jobs/docs/changelog.

gitvan release publish
  Publish npm package, push tags, update docs indexes.

gitvan release rollback --tag v2.0.0
  Yank npm, revert tag, restore previous stable.
```

---

## Responsibilities

* **Release Lead:** Sean
* **QE Lead:** QA owner
* **Docs Lead:** Docs owner
* **Chat Lead:** AI owner
* **Cookbook Lead:** DevEx owner

---

## Success Criteria (Post-GA, 30 days)

* ≥ 3 pilot teams replacing ≥ 3 chores with GitVan jobs.
* Cookbook recipes used ≥ 50 times across pilots.
* < 10 ppm duplicate executions; 0 security incidents.
