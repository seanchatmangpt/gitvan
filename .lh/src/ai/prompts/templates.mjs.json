{
    "sourceFile": "src/ai/prompts/templates.mjs",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1758057329104,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1758057335360,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,179 @@\n+/**\n+ * GitVan v2 AI Prompt Templates - Nunjucks templates for AI generation\n+ * Templates for generating jobs, events, and other GitVan artifacts\n+ */\n+\n+// Job writer template\n+export const JOB_WRITER_TEMPLATE = `\n+Emit ONLY valid ESM for a GitVan job module:\n+\n+import { defineJob } from \"gitvan/define\"\n+\n+export default defineJob({\n+  meta: { \n+    desc: \"{{ desc | default('Generated job') }}\", \n+    tags: {{ tags | default(\"[]\") | safe }}\n+  },\n+  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n+  {% if on %}on: {{ on | safe }},{% endif %}\n+  async run({ ctx, payload }) {\n+    const { useGit } = await import(\"gitvan/composables/git\")\n+    const { useTemplate } = await import(\"gitvan/composables/template\")\n+    const git = useGit()\n+    const tpl = await useTemplate()\n+    \n+    {{ body | default(\"// TODO: implement\") }}\n+    \n+    return { ok: true, artifacts: [] }\n+  }\n+})\n+`;\n+\n+// Event writer template\n+export const EVENT_WRITER_TEMPLATE = `\n+Emit ONLY valid ESM for a GitVan event job module:\n+\n+import { defineJob } from \"gitvan/define\"\n+\n+export default defineJob({\n+  meta: { \n+    desc: \"{{ desc | default('Generated event job') }}\", \n+    tags: {{ tags | default(\"[]\") | safe }}\n+  },\n+  on: {{ on | safe }},\n+  async run({ ctx, payload, meta }) {\n+    const { useGit } = await import(\"gitvan/composables/git\")\n+    const { useTemplate } = await import(\"gitvan/composables/template\")\n+    const git = useGit()\n+    const tpl = await useTemplate()\n+    \n+    {{ body | default(\"// TODO: implement event handler\") }}\n+    \n+    return { ok: true, artifacts: [] }\n+  }\n+})\n+`;\n+\n+// Template generator template\n+export const TEMPLATE_GENERATOR_TEMPLATE = `\n+Generate a Nunjucks template for GitVan:\n+\n+{# {{ name | default('Generated Template') }} #}\n+{# Generated: {{ now | default('now') }} #}\n+\n+{{ content | default('<!-- TODO: implement template -->') }}\n+`;\n+\n+// Changelog template\n+export const CHANGELOG_TEMPLATE = `\n+# Changelog\n+\n+## {{ version | default('Unreleased') }} - {{ date | default('now') | date('YYYY-MM-DD') }}\n+\n+{% if commits %}\n+### Changes\n+{% for commit in commits %}\n+- {{ commit.message | truncate(80) }} ({{ commit.author }})\n+{% endfor %}\n+{% endif %}\n+\n+{% if features %}\n+### Features\n+{% for feature in features %}\n+- {{ feature }}\n+{% endfor %}\n+{% endif %}\n+\n+{% if fixes %}\n+### Fixes\n+{% for fix in fixes %}\n+- {{ fix }}\n+{% endfor %}\n+{% endif %}\n+`;\n+\n+// Release notes template\n+export const RELEASE_NOTES_TEMPLATE = `\n+# Release Notes - {{ version }}\n+\n+**Release Date:** {{ date | default('now') | date('YYYY-MM-DD') }}\n+\n+## Summary\n+{{ summary | default('This release includes various improvements and bug fixes.') }}\n+\n+## What's New\n+{% if features %}\n+{% for feature in features %}\n+- **{{ feature.title }}**: {{ feature.description }}\n+{% endfor %}\n+{% endif %}\n+\n+## Bug Fixes\n+{% if fixes %}\n+{% for fix in fixes %}\n+- {{ fix }}\n+{% endfor %}\n+{% endif %}\n+\n+## Breaking Changes\n+{% if breaking %}\n+{% for change in breaking %}\n+- {{ change }}\n+{% endfor %}\n+{% endif %}\n+\n+## Contributors\n+{% if contributors %}\n+{% for contributor in contributors %}\n+- {{ contributor }}\n+{% endfor %}\n+{% endif %}\n+`;\n+\n+// Dev diary template\n+export const DEV_DIARY_TEMPLATE = `\n+# Dev Diary - {{ date | default('now') | date('YYYY-MM-DD') }}\n+\n+## Today's Focus\n+{{ focus | default('Working on various tasks') }}\n+\n+## Completed\n+{% if completed %}\n+{% for item in completed %}\n+- {{ item }}\n+{% endfor %}\n+{% endif %}\n+\n+## In Progress\n+{% if inProgress %}\n+{% for item in inProgress %}\n+- {{ item }}\n+{% endfor %}\n+{% endif %}\n+\n+## Blockers\n+{% if blockers %}\n+{% for blocker in blockers %}\n+- {{ blocker }}\n+{% endfor %}\n+{% endif %}\n+\n+## Notes\n+{{ notes | default('No additional notes') }}\n+`;\n+\n+// Refinement template\n+export const REFINER_TEMPLATE = `\n+Refine the following {{ type | default('job') }} specification:\n+\n+**Original:**\n+{{ original | safe }}\n+\n+**Requirements:**\n+{{ requirements | default('Improve the specification') }}\n+\n+**Context:**\n+{{ context | default('No additional context') }}\n+\n+Provide an improved version that addresses the requirements while maintaining compatibility with GitVan v2.\n+`;\n"
                },
                {
                    "date": 1758072803590,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -176,183 +176,5 @@\n {{ context | default('No additional context') }}\n \n Provide an improved version that addresses the requirements while maintaining compatibility with GitVan v2.\n `;\n-/**\n- * GitVan v2 AI Prompt Templates - Nunjucks templates for AI generation\n- * Templates for generating jobs, events, and other GitVan artifacts\n- */\n \n-// Job writer template\n-export const JOB_WRITER_TEMPLATE = `\n-Emit ONLY valid ESM for a GitVan job module:\n-\n-import { defineJob } from \"gitvan/define\"\n-\n-export default defineJob({\n-  meta: { \n-    desc: \"{{ desc | default('Generated job') }}\", \n-    tags: {{ tags | default(\"[]\") | safe }}\n-  },\n-  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n-  {% if on %}on: {{ on | safe }},{% endif %}\n-  async run({ ctx, payload }) {\n-    const { useGit } = await import(\"gitvan/composables/git\")\n-    const { useTemplate } = await import(\"gitvan/composables/template\")\n-    const git = useGit()\n-    const tpl = await useTemplate()\n-    \n-    {{ body | default(\"// TODO: implement\") }}\n-    \n-    return { ok: true, artifacts: [] }\n-  }\n-})\n-`;\n-\n-// Event writer template\n-export const EVENT_WRITER_TEMPLATE = `\n-Emit ONLY valid ESM for a GitVan event job module:\n-\n-import { defineJob } from \"gitvan/define\"\n-\n-export default defineJob({\n-  meta: { \n-    desc: \"{{ desc | default('Generated event job') }}\", \n-    tags: {{ tags | default(\"[]\") | safe }}\n-  },\n-  on: {{ on | safe }},\n-  async run({ ctx, payload, meta }) {\n-    const { useGit } = await import(\"gitvan/composables/git\")\n-    const { useTemplate } = await import(\"gitvan/composables/template\")\n-    const git = useGit()\n-    const tpl = await useTemplate()\n-    \n-    {{ body | default(\"// TODO: implement event handler\") }}\n-    \n-    return { ok: true, artifacts: [] }\n-  }\n-})\n-`;\n-\n-// Template generator template\n-export const TEMPLATE_GENERATOR_TEMPLATE = `\n-Generate a Nunjucks template for GitVan:\n-\n-{# {{ name | default('Generated Template') }} #}\n-{# Generated: {{ now | default('now') }} #}\n-\n-{{ content | default('<!-- TODO: implement template -->') }}\n-`;\n-\n-// Changelog template\n-export const CHANGELOG_TEMPLATE = `\n-# Changelog\n-\n-## {{ version | default('Unreleased') }} - {{ date | default('now') | date('YYYY-MM-DD') }}\n-\n-{% if commits %}\n-### Changes\n-{% for commit in commits %}\n-- {{ commit.message | truncate(80) }} ({{ commit.author }})\n-{% endfor %}\n-{% endif %}\n-\n-{% if features %}\n-### Features\n-{% for feature in features %}\n-- {{ feature }}\n-{% endfor %}\n-{% endif %}\n-\n-{% if fixes %}\n-### Fixes\n-{% for fix in fixes %}\n-- {{ fix }}\n-{% endfor %}\n-{% endif %}\n-`;\n-\n-// Release notes template\n-export const RELEASE_NOTES_TEMPLATE = `\n-# Release Notes - {{ version }}\n-\n-**Release Date:** {{ date | default('now') | date('YYYY-MM-DD') }}\n-\n-## Summary\n-{{ summary | default('This release includes various improvements and bug fixes.') }}\n-\n-## What's New\n-{% if features %}\n-{% for feature in features %}\n-- **{{ feature.title }}**: {{ feature.description }}\n-{% endfor %}\n-{% endif %}\n-\n-## Bug Fixes\n-{% if fixes %}\n-{% for fix in fixes %}\n-- {{ fix }}\n-{% endfor %}\n-{% endif %}\n-\n-## Breaking Changes\n-{% if breaking %}\n-{% for change in breaking %}\n-- {{ change }}\n-{% endfor %}\n-{% endif %}\n-\n-## Contributors\n-{% if contributors %}\n-{% for contributor in contributors %}\n-- {{ contributor }}\n-{% endfor %}\n-{% endif %}\n-`;\n-\n-// Dev diary template\n-export const DEV_DIARY_TEMPLATE = `\n-# Dev Diary - {{ date | default('now') | date('YYYY-MM-DD') }}\n-\n-## Today's Focus\n-{{ focus | default('Working on various tasks') }}\n-\n-## Completed\n-{% if completed %}\n-{% for item in completed %}\n-- {{ item }}\n-{% endfor %}\n-{% endif %}\n-\n-## In Progress\n-{% if inProgress %}\n-{% for item in inProgress %}\n-- {{ item }}\n-{% endfor %}\n-{% endif %}\n-\n-## Blockers\n-{% if blockers %}\n-{% for blocker in blockers %}\n-- {{ blocker }}\n-{% endfor %}\n-{% endif %}\n-\n-## Notes\n-{{ notes | default('No additional notes') }}\n-`;\n-\n-// Refinement template\n-export const REFINER_TEMPLATE = `\n-Refine the following {{ type | default('job') }} specification:\n-\n-**Original:**\n-{{ original | safe }}\n-\n-**Requirements:**\n-{{ requirements | default('Improve the specification') }}\n-\n-**Context:**\n-{{ context | default('No additional context') }}\n-\n-Provide an improved version that addresses the requirements while maintaining compatibility with GitVan v2.\n-`;\n"
                },
                {
                    "date": 1758077503384,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,144 @@\n  * GitVan v2 AI Prompt Templates - Nunjucks templates for AI generation\n  * Templates for generating jobs, events, and other GitVan artifacts\n  */\n \n+// Enhanced verbose job writer template with comprehensive guidance\n+export const VERBOSE_JOB_WRITER_TEMPLATE = `\n+# GitVan Job Generator - Comprehensive Template\n+\n+You are an expert GitVan developer creating a production-ready job module. Follow these guidelines:\n+\n+## Context & Requirements\n+- **User Request**: \"{{ prompt }}\"\n+- **Job Type**: {{ kind | default('job') }}\n+- **Target**: {{ target | default('general automation') }}\n+\n+## GitVan Architecture Guidelines\n+\n+### 1. Job Structure\n+- Use \\`defineJob()\\` from \"gitvan/define\"\n+- Include comprehensive \\`meta\\` object with description and tags\n+- Implement proper error handling and logging\n+- Return structured results with \\`artifacts\\` array\n+\n+### 2. Available Composables\n+- **useGit()**: Git operations (commits, refs, notes, branches)\n+- **useTemplate()**: Nunjucks template rendering with front-matter\n+- **usePack()**: Pack system for reusable components\n+- **useJob()**: Job discovery and execution\n+- **useEvent()**: Event handling and scheduling\n+\n+### 3. Template System Integration\n+- Use \\`useTemplate()\\` for file generation with front-matter\n+- Support YAML, TOML, JSON front-matter formats\n+- Implement plan/apply lifecycle for safe operations\n+- Use path sandboxing for security\n+\n+### 4. Git Integration Best Practices\n+- Use atomic operations where possible\n+- Implement proper locking with Git refs\n+- Write receipts to Git notes for audit trails\n+- Handle Git errors gracefully\n+\n+### 5. Security & Safety\n+- Validate all inputs and paths\n+- Use allowlists for shell commands\n+- Implement idempotent operations\n+- Sandbox file operations to project root\n+\n+## Generated Job Template\n+\n+\\`\\`\\`javascript\n+import { defineJob } from \"gitvan/define\"\n+\n+export default defineJob({\n+  meta: { \n+    desc: \"{{ desc | default('Generated job') }}\", \n+    tags: {{ tags | default(\"[]\") | safe }},\n+    author: \"{{ author | default('GitVan AI') }}\",\n+    version: \"{{ version | default('1.0.0') }}\"\n+  },\n+  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n+  {% if on %}on: {{ on | safe }},{% endif %}\n+  {% if schedule %}schedule: \"{{ schedule }}\",{% endif %}\n+  async run({ ctx, payload, meta }) {\n+    const { useGit } = await import(\"gitvan/composables/git\")\n+    const { useTemplate } = await import(\"gitvan/composables/template\")\n+    const { usePack } = await import(\"gitvan/composables/pack\")\n+    \n+    const git = useGit()\n+    const template = await useTemplate()\n+    const pack = await usePack()\n+    \n+    try {\n+      // Job implementation\n+      {{ body | default(\"// TODO: implement job logic\") }}\n+      \n+      return { \n+        ok: true, \n+        artifacts: [],\n+        summary: \"{{ summary | default('Job completed successfully') }}\"\n+      }\n+    } catch (error) {\n+      console.error('Job failed:', error.message)\n+      return { \n+        ok: false, \n+        error: error.message,\n+        artifacts: []\n+      }\n+    }\n+  }\n+})\n+\\`\\`\\`\n+\n+## Implementation Guidelines\n+\n+### Template Usage Examples\n+\\`\\`\\`javascript\n+// Generate files with front-matter\n+const plan = await template.plan('templates/component.njk', { name: 'MyComponent' })\n+const result = await template.apply(plan)\n+\n+// Render templates with data\n+const content = await template.render('templates/readme.njk', {\n+  project: { name: 'my-project', description: 'A great project' }\n+})\n+\\`\\`\\`\n+\n+### Git Operations Examples\n+\\`\\`\\`javascript\n+// Safe Git operations\n+const head = await git.head()\n+const commits = await git.log({ maxCount: 10 })\n+await git.noteAppend('refs/notes/gitvan/results', JSON.stringify(result))\n+\\`\\`\\`\n+\n+### Pack System Examples\n+\\`\\`\\`javascript\n+// Apply packs\n+const packResult = await pack.apply('react-component', {\n+  name: 'Button',\n+  props: ['variant', 'size']\n+})\n+\\`\\`\\`\n+\n+## Requirements for Generated Code\n+\n+1. **Complete Implementation**: Generate fully functional code, not TODOs\n+2. **Error Handling**: Include proper try/catch blocks and error returns\n+3. **Logging**: Add appropriate console.log statements for debugging\n+4. **Documentation**: Include JSDoc comments for complex functions\n+5. **Type Safety**: Use proper parameter destructuring and validation\n+6. **Git Integration**: Leverage Git composables for file operations\n+7. **Template Usage**: Use useTemplate() for file generation when appropriate\n+8. **Security**: Implement path validation and sandboxing\n+9. **Idempotency**: Ensure operations can be run multiple times safely\n+10. **Audit Trail**: Write receipts for important operations\n+\n+Generate a complete, production-ready job that follows all these guidelines.\n+`;\n+\n // Job writer template\n export const JOB_WRITER_TEMPLATE = `\n Emit ONLY valid ESM for a GitVan job module:\n \n@@ -176,5 +312,4 @@\n {{ context | default('No additional context') }}\n \n Provide an improved version that addresses the requirements while maintaining compatibility with GitVan v2.\n `;\n-\n"
                },
                {
                    "date": 1758077516174,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,315 @@\n+/**\n+ * GitVan v2 AI Prompt Templates - Nunjucks templates for AI generation\n+ * Templates for generating jobs, events, and other GitVan artifacts\n+ */\n+\n+// Enhanced verbose job writer template with comprehensive guidance\n+export const VERBOSE_JOB_WRITER_TEMPLATE = `\n+# GitVan Job Generator - Comprehensive Template\n+\n+You are an expert GitVan developer creating a production-ready job module. Follow these guidelines:\n+\n+## Context & Requirements\n+- **User Request**: \"{{ prompt }}\"\n+- **Job Type**: {{ kind | default('job') }}\n+- **Target**: {{ target | default('general automation') }}\n+\n+## GitVan Architecture Guidelines\n+\n+### 1. Job Structure\n+- Use \\`defineJob()\\` from \"gitvan/define\"\n+- Include comprehensive \\`meta\\` object with description and tags\n+- Implement proper error handling and logging\n+- Return structured results with \\`artifacts\\` array\n+\n+### 2. Available Composables\n+- **useGit()**: Git operations (commits, refs, notes, branches)\n+- **useTemplate()**: Nunjucks template rendering with front-matter\n+- **usePack()**: Pack system for reusable components\n+- **useJob()**: Job discovery and execution\n+- **useEvent()**: Event handling and scheduling\n+\n+### 3. Template System Integration\n+- Use \\`useTemplate()\\` for file generation with front-matter\n+- Support YAML, TOML, JSON front-matter formats\n+- Implement plan/apply lifecycle for safe operations\n+- Use path sandboxing for security\n+\n+### 4. Git Integration Best Practices\n+- Use atomic operations where possible\n+- Implement proper locking with Git refs\n+- Write receipts to Git notes for audit trails\n+- Handle Git errors gracefully\n+\n+### 5. Security & Safety\n+- Validate all inputs and paths\n+- Use allowlists for shell commands\n+- Implement idempotent operations\n+- Sandbox file operations to project root\n+\n+## Generated Job Template\n+\n+\\`\\`\\`javascript\n+import { defineJob } from \"gitvan/define\"\n+\n+export default defineJob({\n+  meta: { \n+    desc: \"{{ desc | default('Generated job') }}\", \n+    tags: {{ tags | default(\"[]\") | safe }},\n+    author: \"{{ author | default('GitVan AI') }}\",\n+    version: \"{{ version | default('1.0.0') }}\"\n+  },\n+  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n+  {% if on %}on: {{ on | safe }},{% endif %}\n+  {% if schedule %}schedule: \"{{ schedule }}\",{% endif %}\n+  async run({ ctx, payload, meta }) {\n+    const { useGit } = await import(\"gitvan/composables/git\")\n+    const { useTemplate } = await import(\"gitvan/composables/template\")\n+    const { usePack } = await import(\"gitvan/composables/pack\")\n+    \n+    const git = useGit()\n+    const template = await useTemplate()\n+    const pack = await usePack()\n+    \n+    try {\n+      // Job implementation\n+      {{ body | default(\"// TODO: implement job logic\") }}\n+      \n+      return { \n+        ok: true, \n+        artifacts: [],\n+        summary: \"{{ summary | default('Job completed successfully') }}\"\n+      }\n+    } catch (error) {\n+      console.error('Job failed:', error.message)\n+      return { \n+        ok: false, \n+        error: error.message,\n+        artifacts: []\n+      }\n+    }\n+  }\n+})\n+\\`\\`\\`\n+\n+## Implementation Guidelines\n+\n+### Template Usage Examples\n+\\`\\`\\`javascript\n+// Generate files with front-matter\n+const plan = await template.plan('templates/component.njk', { name: 'MyComponent' })\n+const result = await template.apply(plan)\n+\n+// Render templates with data\n+const content = await template.render('templates/readme.njk', {\n+  project: { name: 'my-project', description: 'A great project' }\n+})\n+\\`\\`\\`\n+\n+### Git Operations Examples\n+\\`\\`\\`javascript\n+// Safe Git operations\n+const head = await git.head()\n+const commits = await git.log({ maxCount: 10 })\n+await git.noteAppend('refs/notes/gitvan/results', JSON.stringify(result))\n+\\`\\`\\`\n+\n+### Pack System Examples\n+\\`\\`\\`javascript\n+// Apply packs\n+const packResult = await pack.apply('react-component', {\n+  name: 'Button',\n+  props: ['variant', 'size']\n+})\n+\\`\\`\\`\n+\n+## Requirements for Generated Code\n+\n+1. **Complete Implementation**: Generate fully functional code, not TODOs\n+2. **Error Handling**: Include proper try/catch blocks and error returns\n+3. **Logging**: Add appropriate console.log statements for debugging\n+4. **Documentation**: Include JSDoc comments for complex functions\n+5. **Type Safety**: Use proper parameter destructuring and validation\n+6. **Git Integration**: Leverage Git composables for file operations\n+7. **Template Usage**: Use useTemplate() for file generation when appropriate\n+8. **Security**: Implement path validation and sandboxing\n+9. **Idempotency**: Ensure operations can be run multiple times safely\n+10. **Audit Trail**: Write receipts for important operations\n+\n+Generate a complete, production-ready job that follows all these guidelines.\n+`;\n+\n+// Job writer template\n+export const JOB_WRITER_TEMPLATE = `\n+Emit ONLY valid ESM for a GitVan job module:\n+\n+import { defineJob } from \"gitvan/define\"\n+\n+export default defineJob({\n+  meta: { \n+    desc: \"{{ desc | default('Generated job') }}\", \n+    tags: {{ tags | default(\"[]\") | safe }}\n+  },\n+  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n+  {% if on %}on: {{ on | safe }},{% endif %}\n+  async run({ ctx, payload }) {\n+    const { useGit } = await import(\"gitvan/composables/git\")\n+    const { useTemplate } = await import(\"gitvan/composables/template\")\n+    const git = useGit()\n+    const tpl = await useTemplate()\n+    \n+    {{ body | default(\"// TODO: implement\") }}\n+    \n+    return { ok: true, artifacts: [] }\n+  }\n+})\n+`;\n+\n+// Event writer template\n+export const EVENT_WRITER_TEMPLATE = `\n+Emit ONLY valid ESM for a GitVan event job module:\n+\n+import { defineJob } from \"gitvan/define\"\n+\n+export default defineJob({\n+  meta: { \n+    desc: \"{{ desc | default('Generated event job') }}\", \n+    tags: {{ tags | default(\"[]\") | safe }}\n+  },\n+  on: {{ on | safe }},\n+  async run({ ctx, payload, meta }) {\n+    const { useGit } = await import(\"gitvan/composables/git\")\n+    const { useTemplate } = await import(\"gitvan/composables/template\")\n+    const git = useGit()\n+    const tpl = await useTemplate()\n+    \n+    {{ body | default(\"// TODO: implement event handler\") }}\n+    \n+    return { ok: true, artifacts: [] }\n+  }\n+})\n+`;\n+\n+// Template generator template\n+export const TEMPLATE_GENERATOR_TEMPLATE = `\n+Generate a Nunjucks template for GitVan:\n+\n+{# {{ name | default('Generated Template') }} #}\n+{# Generated: {{ now | default('now') }} #}\n+\n+{{ content | default('<!-- TODO: implement template -->') }}\n+`;\n+\n+// Changelog template\n+export const CHANGELOG_TEMPLATE = `\n+# Changelog\n+\n+## {{ version | default('Unreleased') }} - {{ date | default('now') | date('YYYY-MM-DD') }}\n+\n+{% if commits %}\n+### Changes\n+{% for commit in commits %}\n+- {{ commit.message | truncate(80) }} ({{ commit.author }})\n+{% endfor %}\n+{% endif %}\n+\n+{% if features %}\n+### Features\n+{% for feature in features %}\n+- {{ feature }}\n+{% endfor %}\n+{% endif %}\n+\n+{% if fixes %}\n+### Fixes\n+{% for fix in fixes %}\n+- {{ fix }}\n+{% endfor %}\n+{% endif %}\n+`;\n+\n+// Release notes template\n+export const RELEASE_NOTES_TEMPLATE = `\n+# Release Notes - {{ version }}\n+\n+**Release Date:** {{ date | default('now') | date('YYYY-MM-DD') }}\n+\n+## Summary\n+{{ summary | default('This release includes various improvements and bug fixes.') }}\n+\n+## What's New\n+{% if features %}\n+{% for feature in features %}\n+- **{{ feature.title }}**: {{ feature.description }}\n+{% endfor %}\n+{% endif %}\n+\n+## Bug Fixes\n+{% if fixes %}\n+{% for fix in fixes %}\n+- {{ fix }}\n+{% endfor %}\n+{% endif %}\n+\n+## Breaking Changes\n+{% if breaking %}\n+{% for change in breaking %}\n+- {{ change }}\n+{% endfor %}\n+{% endif %}\n+\n+## Contributors\n+{% if contributors %}\n+{% for contributor in contributors %}\n+- {{ contributor }}\n+{% endfor %}\n+{% endif %}\n+`;\n+\n+// Dev diary template\n+export const DEV_DIARY_TEMPLATE = `\n+# Dev Diary - {{ date | default('now') | date('YYYY-MM-DD') }}\n+\n+## Today's Focus\n+{{ focus | default('Working on various tasks') }}\n+\n+## Completed\n+{% if completed %}\n+{% for item in completed %}\n+- {{ item }}\n+{% endfor %}\n+{% endif %}\n+\n+## In Progress\n+{% if inProgress %}\n+{% for item in inProgress %}\n+- {{ item }}\n+{% endfor %}\n+{% endif %}\n+\n+## Blockers\n+{% if blockers %}\n+{% for blocker in blockers %}\n+- {{ blocker }}\n+{% endfor %}\n+{% endif %}\n+\n+## Notes\n+{{ notes | default('No additional notes') }}\n+`;\n+\n+// Refinement template\n+export const REFINER_TEMPLATE = `\n+Refine the following {{ type | default('job') }} specification:\n+\n+**Original:**\n+{{ original | safe }}\n+\n+**Requirements:**\n+{{ requirements | default('Improve the specification') }}\n+\n+**Context:**\n+{{ context | default('No additional context') }}\n+\n+Provide an improved version that addresses the requirements while maintaining compatibility with GitVan v2.\n+`;\n"
                },
                {
                    "date": 1758078431494,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,459 +2,181 @@\n  * GitVan v2 AI Prompt Templates - Nunjucks templates for AI generation\n  * Templates for generating jobs, events, and other GitVan artifacts\n  */\n \n-// Enhanced verbose job writer template with comprehensive guidance\n-export const VERBOSE_JOB_WRITER_TEMPLATE = `\n-# GitVan Job Generator - Comprehensive Template\n+// Template-based job generation prompt with comprehensive context\n+export const TEMPLATE_BASED_JOB_PROMPT = `\n+# GitVan v2 - Template-Based Job Generator\n \n-You are an expert GitVan developer creating a production-ready job module. Follow these guidelines:\n+## Overview\n+GitVan is a Git-native development automation platform that transforms Git into a runtime environment. This system generates jobs using structured templates with Zod validation instead of raw code generation.\n \n-## Context & Requirements\n+## Context & Request\n - **User Request**: \"{{ prompt }}\"\n - **Job Type**: {{ kind | default('job') }}\n - **Target**: {{ target | default('general automation') }}\n \n-## GitVan Architecture Guidelines\n+## GitVan Architecture\n \n-### 1. Job Structure\n-- Use \\`defineJob()\\` from \"gitvan/define\"\n-- Include comprehensive \\`meta\\` object with description and tags\n-- Implement proper error handling and logging\n-- Return structured results with \\`artifacts\\` array\n+### Core Concepts\n+- **Git-Native**: Uses Git refs for locking, notes for audit trails\n+- **Composables**: Reusable functions (useGit, useTemplate, usePack)\n+- **Template System**: Nunjucks-powered with front-matter support\n+- **Pack System**: Reusable automation components\n+- **Job System**: Automated task execution with scheduling\n+- **Event System**: File change triggers and webhooks\n \n-### 2. Available Composables\n-- **useGit()**: Git operations (commits, refs, notes, branches)\n-- **useTemplate()**: Nunjucks template rendering with front-matter\n+### Available Composables\n+- **useGit()**: Git operations (commits, refs, notes, branches, worktrees)\n+- **useTemplate()**: Nunjucks template rendering with front-matter (YAML/TOML/JSON)\n - **usePack()**: Pack system for reusable components\n - **useJob()**: Job discovery and execution\n - **useEvent()**: Event handling and scheduling\n \n-### 3. Template System Integration\n-- Use \\`useTemplate()\\` for file generation with front-matter\n-- Support YAML, TOML, JSON front-matter formats\n-- Implement plan/apply lifecycle for safe operations\n-- Use path sandboxing for security\n+### Job Structure\n+Jobs export a default object with:\n+- **meta**: Description, tags, author, version\n+- **config**: Cron, on triggers, schedule\n+- **run()**: Async function with { ctx, payload, meta } parameters\n+- **Return**: { ok: boolean, artifacts: array, summary: string }\n \n-### 4. Git Integration Best Practices\n-- Use atomic operations where possible\n-- Implement proper locking with Git refs\n-- Write receipts to Git notes for audit trails\n-- Handle Git errors gracefully\n+### Template System Features\n+- **Front-matter**: YAML (---), TOML (+++), JSON (;)\n+- **Plan/Apply**: Dry-run planning then execution\n+- **Path Sandboxing**: Security against directory traversal\n+- **Idempotent Operations**: Safe to run multiple times\n+- **Atomic Locking**: Git ref-based concurrency control\n \n-### 5. Security & Safety\n-- Validate all inputs and paths\n-- Use allowlists for shell commands\n-- Implement idempotent operations\n-- Sandbox file operations to project root\n+### Security & Safety\n+- **Path Validation**: All paths validated against project root\n+- **Shell Allowlists**: Configurable command execution\n+- **Audit Trails**: Complete operation logging in Git notes\n+- **Error Handling**: Graceful degradation and recovery\n \n-## Generated Job Template\n+## Job Template Schema\n \n-\\`\\`\\`javascript\n-import { defineJob } from \"gitvan/define\"\n+Generate a JSON object following this Zod schema:\n \n-export default defineJob({\n-  meta: { \n-    desc: \"{{ desc | default('Generated job') }}\", \n-    tags: {{ tags | default(\"[]\") | safe }},\n-    author: \"{{ author | default('GitVan AI') }}\",\n-    version: \"{{ version | default('1.0.0') }}\"\n+\\`\\`\\`json\n+{\n+  \"meta\": {\n+    \"desc\": \"Clear description of what the job does\",\n+    \"tags\": [\"tag1\", \"tag2\"],\n+    \"author\": \"GitVan AI\", \n+    \"version\": \"1.0.0\"\n   },\n-  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n-  {% if on %}on: {{ on | safe }},{% endif %}\n-  {% if schedule %}schedule: \"{{ schedule }}\",{% endif %}\n-  async run({ ctx, payload, meta }) {\n-    const { useGit } = await import(\"gitvan/composables/git\")\n-    const { useTemplate } = await import(\"gitvan/composables/template\")\n-    const { usePack } = await import(\"gitvan/composables/pack\")\n-    \n-    const git = useGit()\n-    const template = await useTemplate()\n-    const pack = await usePack()\n-    \n-    try {\n-      // Job implementation\n-      {{ body | default(\"// TODO: implement job logic\") }}\n-      \n-      return { \n-        ok: true, \n-        artifacts: [],\n-        summary: \"{{ summary | default('Job completed successfully') }}\"\n+  \"config\": {\n+    \"cron\": \"optional cron expression (e.g., '0 2 * * *')\",\n+    \"on\": \"optional event triggers (e.g., ['push', 'pull-request'])\",\n+    \"schedule\": \"optional schedule expression\"\n+  },\n+  \"implementation\": {\n+    \"type\": \"file-operation|git-operation|template-operation|pack-operation|simple\",\n+    \"description\": \"What the job does\",\n+    \"parameters\": [\n+      {\n+        \"name\": \"paramName\",\n+        \"type\": \"string|number|boolean|object|array\",\n+        \"description\": \"Parameter description\",\n+        \"required\": true,\n+        \"default\": \"default value\"\n       }\n-    } catch (error) {\n-      console.error('Job failed:', error.message)\n-      return { \n-        ok: false, \n-        error: error.message,\n-        artifacts: []\n+    ],\n+    \"operations\": [\n+      {\n+        \"type\": \"log|file-read|file-write|file-copy|file-move|git-commit|git-note|template-render|pack-apply\",\n+        \"description\": \"What this operation does\",\n+        \"parameters\": {\n+          \"key\": \"value\"\n+        }\n       }\n+    ],\n+    \"errorHandling\": \"strict|graceful|continue\",\n+    \"returnValue\": {\n+      \"success\": \"Success message\",\n+      \"artifacts\": [\"artifact1\", \"artifact2\"]\n     }\n+  },\n+  \"values\": {\n+    \"specificValue1\": \"filled in value\",\n+    \"specificValue2\": \"another value\"\n   }\n-})\n+}\n \\`\\`\\`\n \n-## Implementation Guidelines\n+## Implementation Types & Operations\n \n-### Template Usage Examples\n-\\`\\`\\`javascript\n-// Generate files with front-matter\n-const plan = await template.plan('templates/component.njk', { name: 'MyComponent' })\n-const result = await template.apply(plan)\n+### file-operation\n+**Purpose**: File system operations, backups, file processing\n+**Operations**:\n+- \\`log\\`: Console logging\n+- \\`file-read\\`: Read file contents\n+- \\`file-write\\`: Write file contents  \n+- \\`file-copy\\`: Copy files/directories\n+- \\`file-move\\`: Move/rename files\n \n-// Render templates with data\n-const content = await template.render('templates/readme.njk', {\n-  project: { name: 'my-project', description: 'A great project' }\n-})\n-\\`\\`\\`\n+**Example Parameters**:\n+- \\`sourcePath\\`: Source file/directory path\n+- \\`destinationPath\\`: Destination path\n+- \\`includePatterns\\`: File patterns to include\n+- \\`excludePatterns\\`: File patterns to exclude\n \n-### Git Operations Examples\n-\\`\\`\\`javascript\n-// Safe Git operations\n-const head = await git.head()\n-const commits = await git.log({ maxCount: 10 })\n-await git.noteAppend('refs/notes/gitvan/results', JSON.stringify(result))\n-\\`\\`\\`\n+### git-operation\n+**Purpose**: Git operations, commit processing, note management\n+**Operations**:\n+- \\`log\\`: Console logging\n+- \\`git-commit\\`: Git commit operations\n+- \\`git-note\\`: Git notes for audit trails\n \n-### Pack System Examples\n-\\`\\`\\`javascript\n-// Apply packs\n-const packResult = await pack.apply('react-component', {\n-  name: 'Button',\n-  props: ['variant', 'size']\n-})\n-\\`\\`\\`\n+**Example Parameters**:\n+- \\`ref\\`: Git reference (branch, tag, commit)\n+- \\`message\\`: Commit or note message\n+- \\`author\\`: Author information\n \n-## Requirements for Generated Code\n+### template-operation\n+**Purpose**: Template rendering, file generation\n+**Operations**:\n+- \\`log\\`: Console logging\n+- \\`template-render\\`: Render Nunjucks templates\n \n-1. **Complete Implementation**: Generate fully functional code, not TODOs\n-2. **Error Handling**: Include proper try/catch blocks and error returns\n-3. **Logging**: Add appropriate console.log statements for debugging\n-4. **Documentation**: Include JSDoc comments for complex functions\n-5. **Type Safety**: Use proper parameter destructuring and validation\n-6. **Git Integration**: Leverage Git composables for file operations\n-7. **Template Usage**: Use useTemplate() for file generation when appropriate\n-8. **Security**: Implement path validation and sandboxing\n-9. **Idempotency**: Ensure operations can be run multiple times safely\n-10. **Audit Trail**: Write receipts for important operations\n+**Example Parameters**:\n+- \\`template\\`: Template file path\n+- \\`data\\`: Template data object\n+- \\`outputPath\\`: Output file path\n \n-Generate a complete, production-ready job that follows all these guidelines.\n-`;\n+### pack-operation\n+**Purpose**: Pack system operations\n+**Operations**:\n+- \\`log\\`: Console logging\n+- \\`pack-apply\\`: Apply pack scaffolds\n \n-// Job writer template\n-export const JOB_WRITER_TEMPLATE = `\n-Emit ONLY valid ESM for a GitVan job module:\n+**Example Parameters**:\n+- \\`packName\\`: Pack identifier\n+- \\`inputs\\`: Pack input parameters\n \n-import { defineJob } from \"gitvan/define\"\n+### simple\n+**Purpose**: Simple logging, basic operations\n+**Operations**:\n+- \\`log\\`: Console logging\n \n-export default defineJob({\n-  meta: { \n-    desc: \"{{ desc | default('Generated job') }}\", \n-    tags: {{ tags | default(\"[]\") | safe }}\n-  },\n-  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n-  {% if on %}on: {{ on | safe }},{% endif %}\n-  async run({ ctx, payload }) {\n-    const { useGit } = await import(\"gitvan/composables/git\")\n-    const { useTemplate } = await import(\"gitvan/composables/template\")\n-    const git = useGit()\n-    const tpl = await useTemplate()\n-    \n-    {{ body | default(\"// TODO: implement\") }}\n-    \n-    return { ok: true, artifacts: [] }\n-  }\n-})\n-`;\n+## Error Handling Strategies\n \n-// Event writer template\n-export const EVENT_WRITER_TEMPLATE = `\n-Emit ONLY valid ESM for a GitVan event job module:\n+- **strict**: Fail fast on any error\n+- **graceful**: Handle errors gracefully, continue if possible\n+- **continue**: Log errors but continue processing\n \n-import { defineJob } from \"gitvan/define\"\n+## Instructions\n \n-export default defineJob({\n-  meta: { \n-    desc: \"{{ desc | default('Generated event job') }}\", \n-    tags: {{ tags | default(\"[]\") | safe }}\n-  },\n-  on: {{ on | safe }},\n-  async run({ ctx, payload, meta }) {\n-    const { useGit } = await import(\"gitvan/composables/git\")\n-    const { useTemplate } = await import(\"gitvan/composables/template\")\n-    const git = useGit()\n-    const tpl = await useTemplate()\n-    \n-    {{ body | default(\"// TODO: implement event handler\") }}\n-    \n-    return { ok: true, artifacts: [] }\n-  }\n-})\n-`;\n+1. **Analyze the user request** and determine the appropriate implementation type\n+2. **Design the job structure** with proper meta, config, and implementation\n+3. **Define parameters** that the job will accept via payload\n+4. **Plan operations** that accomplish the requested functionality\n+5. **Set error handling** strategy appropriate for the use case\n+6. **Fill in values** that map payload parameters to template variables\n \n-// Template generator template\n-export const TEMPLATE_GENERATOR_TEMPLATE = `\n-Generate a Nunjucks template for GitVan:\n-\n-{# {{ name | default('Generated Template') }} #}\n-{# Generated: {{ now | default('now') }} #}\n-\n-{{ content | default('<!-- TODO: implement template -->') }}\n+Generate ONLY the JSON object following the schema above. No additional text or explanations.\n `;\n \n-// Changelog template\n-export const CHANGELOG_TEMPLATE = `\n-# Changelog\n-\n-## {{ version | default('Unreleased') }} - {{ date | default('now') | date('YYYY-MM-DD') }}\n-\n-{% if commits %}\n-### Changes\n-{% for commit in commits %}\n-- {{ commit.message | truncate(80) }} ({{ commit.author }})\n-{% endfor %}\n-{% endif %}\n-\n-{% if features %}\n-### Features\n-{% for feature in features %}\n-- {{ feature }}\n-{% endfor %}\n-{% endif %}\n-\n-{% if fixes %}\n-### Fixes\n-{% for fix in fixes %}\n-- {{ fix }}\n-{% endfor %}\n-{% endif %}\n-`;\n-\n-// Release notes template\n-export const RELEASE_NOTES_TEMPLATE = `\n-# Release Notes - {{ version }}\n-\n-**Release Date:** {{ date | default('now') | date('YYYY-MM-DD') }}\n-\n-## Summary\n-{{ summary | default('This release includes various improvements and bug fixes.') }}\n-\n-## What's New\n-{% if features %}\n-{% for feature in features %}\n-- **{{ feature.title }}**: {{ feature.description }}\n-{% endfor %}\n-{% endif %}\n-\n-## Bug Fixes\n-{% if fixes %}\n-{% for fix in fixes %}\n-- {{ fix }}\n-{% endfor %}\n-{% endif %}\n-\n-## Breaking Changes\n-{% if breaking %}\n-{% for change in breaking %}\n-- {{ change }}\n-{% endfor %}\n-{% endif %}\n-\n-## Contributors\n-{% if contributors %}\n-{% for contributor in contributors %}\n-- {{ contributor }}\n-{% endfor %}\n-{% endif %}\n-`;\n-\n-// Dev diary template\n-export const DEV_DIARY_TEMPLATE = `\n-# Dev Diary - {{ date | default('now') | date('YYYY-MM-DD') }}\n-\n-## Today's Focus\n-{{ focus | default('Working on various tasks') }}\n-\n-## Completed\n-{% if completed %}\n-{% for item in completed %}\n-- {{ item }}\n-{% endfor %}\n-{% endif %}\n-\n-## In Progress\n-{% if inProgress %}\n-{% for item in inProgress %}\n-- {{ item }}\n-{% endfor %}\n-{% endif %}\n-\n-## Blockers\n-{% if blockers %}\n-{% for blocker in blockers %}\n-- {{ blocker }}\n-{% endfor %}\n-{% endif %}\n-\n-## Notes\n-{{ notes | default('No additional notes') }}\n-`;\n-\n-// Refinement template\n-export const REFINER_TEMPLATE = `\n-Refine the following {{ type | default('job') }} specification:\n-\n-**Original:**\n-{{ original | safe }}\n-\n-**Requirements:**\n-{{ requirements | default('Improve the specification') }}\n-\n-**Context:**\n-{{ context | default('No additional context') }}\n-\n-Provide an improved version that addresses the requirements while maintaining compatibility with GitVan v2.\n-`;\n-/**\n- * GitVan v2 AI Prompt Templates - Nunjucks templates for AI generation\n- * Templates for generating jobs, events, and other GitVan artifacts\n- */\n-\n-// Enhanced verbose job writer template with comprehensive guidance\n-export const VERBOSE_JOB_WRITER_TEMPLATE = `\n-# GitVan Job Generator - Comprehensive Template\n-\n-You are an expert GitVan developer creating a production-ready job module. Follow these guidelines:\n-\n-## Context & Requirements\n-- **User Request**: \"{{ prompt }}\"\n-- **Job Type**: {{ kind | default('job') }}\n-- **Target**: {{ target | default('general automation') }}\n-\n-## GitVan Architecture Guidelines\n-\n-### 1. Job Structure\n-- Use \\`defineJob()\\` from \"gitvan/define\"\n-- Include comprehensive \\`meta\\` object with description and tags\n-- Implement proper error handling and logging\n-- Return structured results with \\`artifacts\\` array\n-\n-### 2. Available Composables\n-- **useGit()**: Git operations (commits, refs, notes, branches)\n-- **useTemplate()**: Nunjucks template rendering with front-matter\n-- **usePack()**: Pack system for reusable components\n-- **useJob()**: Job discovery and execution\n-- **useEvent()**: Event handling and scheduling\n-\n-### 3. Template System Integration\n-- Use \\`useTemplate()\\` for file generation with front-matter\n-- Support YAML, TOML, JSON front-matter formats\n-- Implement plan/apply lifecycle for safe operations\n-- Use path sandboxing for security\n-\n-### 4. Git Integration Best Practices\n-- Use atomic operations where possible\n-- Implement proper locking with Git refs\n-- Write receipts to Git notes for audit trails\n-- Handle Git errors gracefully\n-\n-### 5. Security & Safety\n-- Validate all inputs and paths\n-- Use allowlists for shell commands\n-- Implement idempotent operations\n-- Sandbox file operations to project root\n-\n-## Generated Job Template\n-\n-\\`\\`\\`javascript\n-import { defineJob } from \"gitvan/define\"\n-\n-export default defineJob({\n-  meta: { \n-    desc: \"{{ desc | default('Generated job') }}\", \n-    tags: {{ tags | default(\"[]\") | safe }},\n-    author: \"{{ author | default('GitVan AI') }}\",\n-    version: \"{{ version | default('1.0.0') }}\"\n-  },\n-  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n-  {% if on %}on: {{ on | safe }},{% endif %}\n-  {% if schedule %}schedule: \"{{ schedule }}\",{% endif %}\n-  async run({ ctx, payload, meta }) {\n-    const { useGit } = await import(\"gitvan/composables/git\")\n-    const { useTemplate } = await import(\"gitvan/composables/template\")\n-    const { usePack } = await import(\"gitvan/composables/pack\")\n-    \n-    const git = useGit()\n-    const template = await useTemplate()\n-    const pack = await usePack()\n-    \n-    try {\n-      // Job implementation\n-      {{ body | default(\"// TODO: implement job logic\") }}\n-      \n-      return { \n-        ok: true, \n-        artifacts: [],\n-        summary: \"{{ summary | default('Job completed successfully') }}\"\n-      }\n-    } catch (error) {\n-      console.error('Job failed:', error.message)\n-      return { \n-        ok: false, \n-        error: error.message,\n-        artifacts: []\n-      }\n-    }\n-  }\n-})\n-\\`\\`\\`\n-\n-## Implementation Guidelines\n-\n-### Template Usage Examples\n-\\`\\`\\`javascript\n-// Generate files with front-matter\n-const plan = await template.plan('templates/component.njk', { name: 'MyComponent' })\n-const result = await template.apply(plan)\n-\n-// Render templates with data\n-const content = await template.render('templates/readme.njk', {\n-  project: { name: 'my-project', description: 'A great project' }\n-})\n-\\`\\`\\`\n-\n-### Git Operations Examples\n-\\`\\`\\`javascript\n-// Safe Git operations\n-const head = await git.head()\n-const commits = await git.log({ maxCount: 10 })\n-await git.noteAppend('refs/notes/gitvan/results', JSON.stringify(result))\n-\\`\\`\\`\n-\n-### Pack System Examples\n-\\`\\`\\`javascript\n-// Apply packs\n-const packResult = await pack.apply('react-component', {\n-  name: 'Button',\n-  props: ['variant', 'size']\n-})\n-\\`\\`\\`\n-\n-## Requirements for Generated Code\n-\n-1. **Complete Implementation**: Generate fully functional code, not TODOs\n-2. **Error Handling**: Include proper try/catch blocks and error returns\n-3. **Logging**: Add appropriate console.log statements for debugging\n-4. **Documentation**: Include JSDoc comments for complex functions\n-5. **Type Safety**: Use proper parameter destructuring and validation\n-6. **Git Integration**: Leverage Git composables for file operations\n-7. **Template Usage**: Use useTemplate() for file generation when appropriate\n-8. **Security**: Implement path validation and sandboxing\n-9. **Idempotency**: Ensure operations can be run multiple times safely\n-10. **Audit Trail**: Write receipts for important operations\n-\n-Generate a complete, production-ready job that follows all these guidelines.\n-`;\n-\n // Job writer template\n export const JOB_WRITER_TEMPLATE = `\n Emit ONLY valid ESM for a GitVan job module:\n \n"
                }
            ],
            "date": 1758057329104,
            "name": "Commit-0",
            "content": "/**\n * GitVan v2 AI Prompt Templates - Nunjucks templates for AI generation\n * Templates for generating jobs, events, and other GitVan artifacts\n */\n\n// Job writer template\nexport const JOB_WRITER_TEMPLATE = `\nEmit ONLY valid ESM for a GitVan job module:\n\nimport { defineJob } from \"gitvan/define\"\n\nexport default defineJob({\n  meta: { \n    desc: \"{{ desc | default('Generated job') }}\", \n    tags: {{ tags | default(\"[]\") | safe }}\n  },\n  {% if cron %}cron: \"{{ cron }}\",{% endif %}\n  {% if on %}on: {{ on | safe }},{% endif %}\n  async run({ ctx, payload }) {\n    const { useGit } = await import(\"gitvan/composables/git\")\n    const { useTemplate } = await import(\"gitvan/composables/template\")\n    const git = useGit()\n    const tpl = await useTemplate()\n    \n    {{ body | default(\"// TODO: implement\") }}\n    \n    return { ok: true, artifacts: [] }\n  }\n})\n`;\n\n// Event writer template\nexport const EVENT_WRITER_TEMPLATE = `\nEmit ONLY valid ESM for a GitVan event job module:\n\nimport { defineJob } from \"gitvan/define\"\n\nexport default defineJob({\n  meta: { \n    desc: \"{{ desc | default('Generated event job') }}\", \n    tags: {{ tags | default(\"[]\") | safe }}\n  },\n  on: {{ on | safe }},\n  async run({ ctx, payload, meta }) {\n    const { useGit } = await import(\"gitvan/composables/git\")\n    const { useTemplate } = await import(\"gitvan/composables/template\")\n    const git = useGit()\n    const tpl = await useTemplate()\n    \n    {{ body | default(\"// TODO: implement event handler\") }}\n    \n    return { ok: true, artifacts: [] }\n  }\n})\n`;\n\n// Template generator template\nexport const TEMPLATE_GENERATOR_TEMPLATE = `\nGenerate a Nunjucks template for GitVan:\n\n{# {{ name | default('Generated Template') }} #}\n{# Generated: {{ now | default('now') }} #}\n\n{{ content | default('<!-- TODO: implement template -->') }}\n`;\n\n// Changelog template\nexport const CHANGELOG_TEMPLATE = `\n# Changelog\n\n## {{ version | default('Unreleased') }} - {{ date | default('now') | date('YYYY-MM-DD') }}\n\n{% if commits %}\n### Changes\n{% for commit in commits %}\n- {{ commit.message | truncate(80) }} ({{ commit.author }})\n{% endfor %}\n{% endif %}\n\n{% if features %}\n### Features\n{% for feature in features %}\n- {{ feature }}\n{% endfor %}\n{% endif %}\n\n{% if fixes %}\n### Fixes\n{% for fix in fixes %}\n- {{ fix }}\n{% endfor %}\n{% endif %}\n`;\n\n// Release notes template\nexport const RELEASE_NOTES_TEMPLATE = `\n# Release Notes - {{ version }}\n\n**Release Date:** {{ date | default('now') | date('YYYY-MM-DD') }}\n\n## Summary\n{{ summary | default('This release includes various improvements and bug fixes.') }}\n\n## What's New\n{% if features %}\n{% for feature in features %}\n- **{{ feature.title }}**: {{ feature.description }}\n{% endfor %}\n{% endif %}\n\n## Bug Fixes\n{% if fixes %}\n{% for fix in fixes %}\n- {{ fix }}\n{% endfor %}\n{% endif %}\n\n## Breaking Changes\n{% if breaking %}\n{% for change in breaking %}\n- {{ change }}\n{% endfor %}\n{% endif %}\n\n## Contributors\n{% if contributors %}\n{% for contributor in contributors %}\n- {{ contributor }}\n{% endfor %}\n{% endif %}\n`;\n\n// Dev diary template\nexport const DEV_DIARY_TEMPLATE = `\n# Dev Diary - {{ date | default('now') | date('YYYY-MM-DD') }}\n\n## Today's Focus\n{{ focus | default('Working on various tasks') }}\n\n## Completed\n{% if completed %}\n{% for item in completed %}\n- {{ item }}\n{% endfor %}\n{% endif %}\n\n## In Progress\n{% if inProgress %}\n{% for item in inProgress %}\n- {{ item }}\n{% endfor %}\n{% endif %}\n\n## Blockers\n{% if blockers %}\n{% for blocker in blockers %}\n- {{ blocker }}\n{% endfor %}\n{% endif %}\n\n## Notes\n{{ notes | default('No additional notes') }}\n`;\n\n// Refinement template\nexport const REFINER_TEMPLATE = `\nRefine the following {{ type | default('job') }} specification:\n\n**Original:**\n{{ original | safe }}\n\n**Requirements:**\n{{ requirements | default('Improve the specification') }}\n\n**Context:**\n{{ context | default('No additional context') }}\n\nProvide an improved version that addresses the requirements while maintaining compatibility with GitVan v2.\n`;\n"
        }
    ]
}